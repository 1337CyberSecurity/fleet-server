{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Agent",
  "description": "An Elastic Agent that has enrolled into Fleet",
  "type": "object",
  "properties": {
    "_id": {
      "description": "The unique identifier for the Elastic Agent",
      "type": "string",
      "format": "uuid"
    },
    "_version": {
      "description": "The version of the document in the index",
      "type": "integer"
    },
    "agent_version": {
      "description": "The version of the Elastic Agent",
      "type": "string"
    },
    "local_metadata": {
      "description": "Local metadata information for the Elastic Agent",
      "type": "object",
      "additionalProperties": true
    },
    "access_api_key_id": {
      "description": "ID of the API key the Elastic Agent must used to contact Fleet Server",
      "type": "integer"
    },
    "default_api_key": {
      "description": "API key the Elastic Agent uses to authenticate with elasticsearch",
      "type": "string"
    },
    "default_api_key_id": {
      "description": "ID of the API key the Elastic Agent uses to authenticate with elasticsearch",
      "type": "integer"
    },
    "policy_id": {
      "description": "The policy ID for the Elastic Agent",
      "type": "string",
      "format": "uuid"
    },
    "policy_revision": {
      "description": "The current policy revision for the Elastic Agent",
      "type": "integer"
    },
    "enrolled_at": {
      "description": "Date/time the Elastic Agent enrolled",
      "type": "string",
      "format": "date-time"
    },
    "unenrolled_at": {
      "description": "Date/time the Elastic Agent unenrolled",
      "type": "string",
      "format": "date-time"
    },
    "unenrollment_started_at": {
      "description": "Date/time the Elastic Agent unenrolled started",
      "type": "string",
      "format": "date-time"
    },
    "upgraded_at": {
      "description": "Date/time the Elastic Agent was last upgraded",
      "type": "string",
      "format": "date-time"
    },
    "upgrade_started_at": {
      "description": "Date/time the Elastic Agent started the current upgrade",
      "type": "string",
      "format": "date-time"
    },
    "updated_at": {
      "description": "Date/time the Elastic Agent was last updated",
      "type": "string",
      "format": "date-time"
    }
  },
  "required": [
    "_id",
    "_version",
    "agent_version",
    "access_api_key_id",
    "policy_id",
    "enrolled_at",
    "updated_at"
  ]
}
