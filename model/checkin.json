{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Checkin",
  "description": "An Elastic Agent checkin to Fleet",
  "type": "object",
  "properties": {
    "_id": {
      "description": "The unique identifier for the Elastic Agent checkin",
      "type": "string",
      "format": "uuid"
    },
    "@timestamp": {
      "description": "Date/time the checkin was created",
      "type": "string",
      "format": "date-time"
    },
    "agent": {
      "title": "Checkin Agent",
      "description": "The current metadata information for the Elastic Agent",
      "type": "object",
      "properties": {
        "id": {
          "description": "The ID for the Elastic Agent",
          "type": "string",
          "format": "uuid"
        },
        "version": {
          "description": "The version of the Elastic Agent",
          "type": "string"
        }
      },
      "required": [
        "id",
        "version"
      ]
    },
    "host": {
      "title": "Checkin Host",
      "description": "The current host information for the Elastic Agent",
      "type": "object",
      "properties": {
        "id": {
          "description": "The ID of the host",
          "type": "string"
        },
        "architecture": {
          "description": "The architecture for the Elastic Agent",
          "type": "string"
        },
        "name": {
          "description": "The hostname of the Elastic Agent",
          "type": "string"
        }
      },
      "required": [
        "id",
        "architecture",
        "name"
      ]
    },
    "status": {
      "description": "The current overall status of the Elastic Agent",
      "type": "string",
      "enum": ["enrolling", "healthy", "error", "degraded", "offline", "unenrolling", "upgrading"]
    },
    "message": {
      "description": "The current overall status message of the Elastic Agent",
      "type": "string"
    },
    "policy": {
      "title": "Checkin Policy",
      "description": "The current status of the applied policy",
      "type": "object",
      "properties": {
        "id": {
          "description": "The ID for the policy",
          "type": "string",
          "format": "uuid"
        },
        "revision": {
          "description": "The revision of the policy",
          "type": "integer"
        },
        "inputs": {
          "title": "Checkin Policy Input",
          "description": "The current input status per policy",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "description": "The ID for the input",
                "type": "string",
                "format": "uuid"
              },
              "template_id": {
                "description": "The template ID for the input",
                "type": "string",
                "format": "uuid"
              },
              "status": {
                "description": "The current status of the input",
                "type": "string",
                "enum": ["healthy", "error", "degraded"]
              },
              "message": {
                "description": "The current status message of the intput",
                "type": "string"
              }
            },
            "required": [
              "id",
              "template_id",
              "status",
              "message"
            ]
          }
        }
      },
      "required": [
        "id",
        "revision",
        "inputs"
      ]
    }
  },
  "required": [
    "_id",
    "@timestamp",
    "agent",
    "status",
    "message",
    "enrolled_at",
    "updated_at"
  ]
}
